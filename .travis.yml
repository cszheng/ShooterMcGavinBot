language: any
services:
  - docker
branches:
  except:
    - /^v[0-9]/
env:
  RELEASE=true
  RELEASE_VERSION=v0.1.0
pre_install: 
  - # Starting build for cszheng/ShooterMcGavinBot...
  - chmod a+x git_release.sh
install:
  - # Building docker image...
  - docker build -t cszheng/shooter-mcgavin-bot .
script:
  - # Running tests...
  - docker run -e DOTNETCORE_ENVIRONMENT=$DOTNETCORE_ENVIRONMENT -e DISCORDBOT_TOKEN=$DISCORDBOT_TOKEN cszheng/shooter-mcgavin-bot ./test.sh
after_success:
  - if [ "$TRAVIS_BRANCH" == "master" ] && [ "$RELEASE" == "true" ]; then      
      ./git_release.sh;     
    fi 
  - # Pushing build tag to github...  
  - # Pushing docker image to dockerhub...
  - # if [ "$TRAVIS_BRANCH" == "master" ]; then docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"; docker push cszheng/shooter-mcgavin-bot; fi